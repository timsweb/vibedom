title = "Vibedom Gitleaks Config"

[allowlist]
description = "Global allowlist for common false positives"
paths = [
    '''node_modules/''',
    '''vendor/''',
    '''.git/''',
]

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey)['":\s]*[=:]\s*['"]?[a-z0-9_-]{20,}['"]?'''
tags = ["key", "API"]

[[rules]]
id = "gitlab-token"
description = "GitLab Personal Access Token"
regex = '''glpat-[A-Za-z0-9_-]{20,}'''
tags = ["gitlab", "token"]

[[rules]]
id = "database-password"
description = "Database Password"
regex = '''(?i)(db[_-]?password|database[_-]?password)['":\s]*[=:]\s*['"]?[^'"\s]+['"]?'''
tags = ["database", "password"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''\b((?:A3T[A-Z0-9]|AKIA|ASIA|ABIA|ACCA)[A-Z2-7]{16})\b'''
tags = ["aws", "key"]

[[rules]]
id = "stripe-api-key"
description = "Stripe API Key"
regex = '''\b((?:sk|rk)_(?:test|live|prod)_[a-zA-Z0-9]{10,99})\b'''
tags = ["stripe", "key"]

[[rules]]
id = "openai-api-key"
description = "OpenAI API Key"
regex = '''\b(sk-[a-zA-Z0-9]{20,})\b'''
tags = ["openai", "key"]

[[rules]]
id = "github-pat"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["github", "token"]

[[rules]]
id = "github-fine-grained-pat"
description = "GitHub Fine-Grained Personal Access Token"
regex = '''github_pat_\w{82}'''
tags = ["github", "token"]

[[rules]]
id = "slack-bot-token"
description = "Slack Bot Token"
regex = '''xoxb-[0-9]{10,13}-[0-9]{10,13}[a-zA-Z0-9-]*'''
tags = ["slack", "token"]

[[rules]]
id = "slack-webhook"
description = "Slack Webhook URL"
regex = '''hooks\.slack\.com/(?:services|workflows|triggers)/[A-Za-z0-9+/]{43,56}'''
tags = ["slack", "webhook"]

[[rules]]
id = "private-key"
description = "Private Key Header"
regex = '''-----BEGIN[ A-Z0-9_-]{0,100}PRIVATE KEY[ A-Z0-9_-]{0,100}-----'''
tags = ["key", "private"]

[[rules]]
id = "jwt-token"
description = "JSON Web Token"
regex = '''\b(ey[a-zA-Z0-9]{17,}\.ey[a-zA-Z0-9/_-]{17,}\.[a-zA-Z0-9/_-]{10,}={0,2})\b'''
tags = ["jwt", "token"]

[[rules]]
id = "generic-password"
description = "Generic Password Assignment"
regex = '''(?i)(password|passwd|pwd)['":\s]*[=:]\s*['"]?[^'"\s]{8,}['"]?'''
tags = ["password"]

[[rules]]
id = "connection-string"
description = "Database Connection String"
regex = '''(?i)(mongodb|postgres|mysql|redis|amqp):\/\/[^:]+:[^@]+@[^\s'"]+'''
tags = ["database", "connection"]

[[rules]]
id = "bearer-token"
description = "Bearer Token in Text"
regex = '''(?i)bearer\s+[a-zA-Z0-9_-]{20,}'''
tags = ["token", "auth"]
